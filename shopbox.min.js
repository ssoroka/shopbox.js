(function(){var d;d=function(){function b(){}b.box=null;b.template='    <div class="shopbox shopbox-hidden">      <div class="shopbox-spinner"></div>      <div class="shopbox-main">        <div class="shopbox-inner">          <a class="shopbox-close" href="#">Close</a>          <div class="shopbox-content"></div>        </div>      </div>    </div>  ';b.init=function(){if(!$(".shopbox").length>0)return $("body").prepend(this.template),$(".shopbox-close").click(b.closeBox),$("body").bind("keydown",
function(a){if(a.which===27)return b.closeBox()}),$(".shopbox").bind("click",function(a){if(a.target===this)return b.closeBox()})};b.show=function(){console.log("show");$(".shopbox").removeClass("shopbox-hidden");return setTimeout(function(){console.log("show setTimeout");return $(".shopbox").addClass("shopbox-visible")},0)};b.closeBox=function(a){a&&a.preventDefault();$(".shopbox .shopbox-content").html("");return b.hide()};b.hide=function(){if($(".shopbox").hasClass("shopbox-visible"))return $(".shopbox").removeClass("shopbox-visible"),
$(".shopbox").transitionEnd(function(){$(".shopbox").addClass("shopbox-hidden");return $(".shopbox-main").removeClass("shopbox-visible")})};b.startSpinner=function(){console.log("startSpinner");$(".shopbox-spinner").addClass("shopbox-visible");return $(".shopbox-main").removeClass("shopbox-visible")};b.finishSpinner=function(a){var b;console.log("finishSpinner");a=a.target;b=$(".shopbox-spinner");if(b.hasClass("shopbox-visible"))return b.removeClass("shopbox-visible"),$(".shopbox-main").addClass("shopbox-visible"),
console.log("Setting content to:"),console.log(a),$(".shopbox .shopbox-content").html(a),$(".shopbox").addClass("shopbox-loaded")};b.setTypeStyle=function(a){return $(".shopbox").removeClass("shopbox-content shopbox-image shopbox-iframe").addClass(a)};b.loadFromUrl=function(a,c,d){var e,f;a===void 0&&(a=d.attr("href"));c=c.type||this.typeFromUrl(a);b.show();c!=="content"&&(f=""+a+"?"+Math.random()*1E18,b.startSpinner());this.setTypeStyle("shopbox-"+c);switch(c){case "image":return a=$("<img />"),
a.load(b.finishSpinner),a.attr("src",f),window.img=a;case "iframe":return e=$("<iframe ></iframe>"),e.hide(),e.load(function(a){e.show();return b.finishSpinner(a)}),e.attr("src",f),$(".shopbox .shopbox-content").append(e);default:return $(".shopbox .shopbox-content").html(a)}};b.typeFromUrl=function(a){return["jpg","jpeg","png","bmp","gif"].indexOf(a.split(".").pop().toLowerCase())>=0?"image":a.match(/^https?\:\/\/\S+$/)?"iframe":"content"};return b}();window.ShopBox=d;jQuery.fn.shopbox=function(b,
a){var c;a==null&&(a={});c=this;d.init();return c.click(function(g){g.preventDefault();return d.loadFromUrl(b,a,c)})};jQuery.fn.transitionEnd=function(b){return this.one("TransitionEnd webkitTransitionEnd transitionend oTransitionEnd",b)}}).call(this);
