(function(){var f;f=function(){function b(){}b.box=null;b.template='    <div class="shopbox shopbox-hidden">      <div class="shopbox-spinner"></div>      <div class="shopbox-main">        <div class="shopbox-inner">          <a class="shopbox-close" href="#">Close</a>          <div class="shopbox-content"></div>        </div>      </div>    </div>  ';b.init=function(){if(!$(".shopbox").length>0)return $("body").prepend(this.template),$(".shopbox-close").click(b.closeBox),$("body").bind("keydown",
function(a){if(a.which===27)return b.closeBox()}),$(".shopbox, .shopbox-spinner").bind("click",function(a){if(a.target===this)return b.closeBox()})};b.show=function(){$(".shopbox").removeClass("shopbox-hidden");return setTimeout(function(){return $(".shopbox").addClass("shopbox-visible")},0)};b.closeBox=function(a){a&&a.preventDefault();return b.hide()};b.hide=function(){if($(".shopbox").hasClass("shopbox-visible"))return $(".shopbox").removeClass("shopbox-visible"),$(".shopbox").transitionEnd(function(){$(".shopbox").addClass("shopbox-hidden");
$(".shopbox-main").removeClass("shopbox-visible");return $(".shopbox").removeClass("shopbox-loaded")})};b.startSpinner=function(){$(".shopbox-spinner").addClass("shopbox-visible");return $(".shopbox-main").removeClass("shopbox-visible")};b.finishSpinner=function(a){var b,a=a.target||a;b=$(".shopbox-spinner");b.hasClass("shopbox-visible")&&b.removeClass("shopbox-visible");$(".shopbox-main").addClass("shopbox-visible");$(".shopbox .shopbox-content").html(a);return $(".shopbox").addClass("shopbox-loaded")};
b.setTypeStyle=function(a){return $(".shopbox").removeClass("shopbox-html shopbox-image shopbox-iframe shopbox-video").addClass(a)};b.loadFromUrl=function(a,e,c){var d,f;a===void 0&&(a=c.attr("href"));c=e.type||this.typeFromUrl(a);b.show();c!=="content"&&(f=""+a+"?"+Math.random()*1E18,b.startSpinner());this.setTypeStyle("shopbox-"+c);switch(c){case "image":return a=$("<img />"),a.load(function(a){b.setSize({height:e.height||this.height,width:e.width||this.width});return b.finishSpinner(a)}),a.attr("src",
f),window.img=a;case "iframe":return d=$("<iframe></iframe>"),d.hide(),a={height:e.height||400,width:e.width||600},d.css(a),b.setSize(a),d.load(function(a){d.show();return b.finishSpinner(a)}),d.attr("src",f),$(".shopbox .shopbox-content").append(d);default:return b.setSize(e),b.finishSpinner(a)}};b.setSize=function(a){var b,c,d;d=document.width-50;c=document.height-50;if(d<a.width)a.width=d;if(c<a.height)a.height=c;a.height||(a.height="");a.width||(a.width="");b=$(".shopbox-content");b.css(a);return setTimeout(function(){return $(".shopbox-main").css({"margin-left":-b.width()/
2-10,"margin-top":-b.height()/2-10})},0)};b.typeFromUrl=function(a){return["jpg","jpeg","png","bmp","gif"].indexOf(a.split(".").pop().toLowerCase())>=0?"image":a.match(/^https?\:\/\/\S+$/)?"iframe":"html"};return b}();window.ShopBox=f;jQuery.fn.shopbox=function(b,a){var e;a==null&&(a={});e=this;f.init();return e.click(function(c){c.preventDefault();return f.loadFromUrl(b,a,e)})};jQuery.fn.transitionEnd=function(b){return this.one("TransitionEnd webkitTransitionEnd transitionend oTransitionEnd",b)}}).call(this);
