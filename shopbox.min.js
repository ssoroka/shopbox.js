(function(){var e;e=function(){function b(){}b.box=null;b.template='    <div class="shopbox shopbox-hidden">      <div class="shopbox-spinner"></div>      <div class="shopbox-main">        <div class="shopbox-inner">          <a class="shopbox-close" href="#">Close</a>          <div class="shopbox-content"></div>        </div>      </div>    </div>  ';b.init=function(){if(!$(".shopbox").length>0)return $("body").prepend(this.template),$(".shopbox-close").click(b.closeBox),$(window).bind("keydown",
function(a){if(a.which===27)return b.closeBox()}),$(".shopbox, .shopbox-spinner").bind("click",function(a){if(a.target===this)return b.closeBox()})};b.show=function(){$(".shopbox").removeClass("shopbox-hidden");return setTimeout(function(){return $(".shopbox").addClass("shopbox-visible")},0)};b.closeBox=function(a){a&&a.preventDefault();return b.hide()};b.hide=function(){if($(".shopbox").hasClass("shopbox-visible"))return $(".shopbox").removeClass("shopbox-visible"),$(".shopbox").transitionEnd(function(){$(".shopbox").addClass("shopbox-hidden");
$(".shopbox-main").removeClass("shopbox-visible");return $(".shopbox").removeClass("shopbox-loaded")})};b.startSpinner=function(){$(".shopbox-spinner").addClass("shopbox-visible");return $(".shopbox-main").removeClass("shopbox-visible")};b.finishSpinner=function(a){var b,a=a.target||a;b=$(".shopbox-spinner");b.hasClass("shopbox-visible")&&b.removeClass("shopbox-visible");$(".shopbox-main").addClass("shopbox-visible");$(".shopbox .shopbox-content").html(a);return $(".shopbox").addClass("shopbox-loaded")};
b.setTypeStyle=function(a){return $(".shopbox").removeClass("shopbox-html shopbox-image shopbox-iframe shopbox-video").addClass(a)};b.loadFromUrl=function(a,d,c){var f,g,e;a===void 0&&(a=c.attr("href"));c=d.type||this.typeFromUrl(a);$(".shopbox-content").css({width:"",height:""});$(".shopbox-main").css({"margin-left":"","margin-top":""});b.show();c!=="content"&&(e=""+a+"?"+Math.random()*1E18,b.startSpinner());this.setTypeStyle("shopbox-"+c);switch(c){case "image":return c=$("<img />"),c.load(function(a){b.setSize({height:d.height||
this.height,width:d.width||this.width});return b.finishSpinner(a)}),c.attr("src",e),window.img=c;case "iframe":return g=$("<iframe></iframe>"),g.hide(),c={height:d.height||400,width:d.width||600},g.css(c),b.setSize(c),g.load(function(a){g.show();return b.finishSpinner(a)}),g.attr("src",e),$(".shopbox .shopbox-content").html(g);default:return f=$("<div />").css({display:"none"}),$(".shopbox .shopbox-content").html(f),f.ready(function(){return setTimeout(function(){$(".shopbox-main").css({"margin-left":-f.width()/
2-10,"margin-top":-f.height()/2-10});f.remove();return b.finishSpinner(a)},0)}),f.html(a)}};b.setSize=function(a){var b,c;c=document.width-50;b=document.height-50;if(c<a.width)a.width=c;if(b<a.height)a.height=b;$(".shopbox-content").css(a);return $(".shopbox-main").css({"margin-left":-a.width/2-10,"margin-top":-a.height/2-10})};b.typeFromUrl=function(a){return["jpg","jpeg","png","bmp","gif"].indexOf(a.split(".").pop().toLowerCase())>=0?"image":a.match(/^https?\:\/\/\S+$/)?"iframe":"html"};return b}();
window.ShopBox=e;jQuery.fn.shopbox=function(b,a){var d;a==null&&(a={});d=this;e.init();return d.click(function(c){c.preventDefault();return e.loadFromUrl(b,a,d)})};jQuery.fn.transitionEnd=function(b){return this.one("TransitionEnd webkitTransitionEnd transitionend oTransitionEnd",b)}}).call(this);
