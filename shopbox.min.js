(function(){var h;h=function(){function a(){}var e;a.name="ShopBox";a.box=null;a.template='    <div class="shopbox shopbox-hidden">      <div class="shopbox-spinner"></div>      <div class="shopbox-main">        <div class="shopbox-inner">          <a class="shopbox-close" href="#">Close</a>          <div class="shopbox-content"></div>        </div>      </div>    </div>  ';a.init=function(){if($(".shopbox").length===0)return $("body").prepend(this.template),$(".shopbox-close").click(a.closeBox),
$(window).bind("keydown",function(b){if(b.which===27)return a.closeBox()}),$(".shopbox, .shopbox-spinner").bind("click",function(b){if(b.target===this)return a.closeBox()})};a.show=function(){$(".shopbox").removeClass("shopbox-hidden");return setTimeout(function(){return $(".shopbox").addClass("shopbox-visible")},0)};a.closeBox=function(b){b&&b.preventDefault();return a.hide()};a.hide=function(){if($(".shopbox").hasClass("shopbox-visible"))return $(".shopbox").removeClass("shopbox-visible"),$(".shopbox").transitionEnd(function(){$(".shopbox").addClass("shopbox-hidden");
$(".shopbox-main").removeClass("shopbox-visible");return $(".shopbox").removeClass("shopbox-loaded")})};a.startSpinner=function(){$(".shopbox-spinner").addClass("shopbox-visible");return $(".shopbox-main").removeClass("shopbox-visible")};a.finishSpinner=function(b){var a,b=b.target||b;a=$(".shopbox-spinner");a.hasClass("shopbox-visible")&&a.removeClass("shopbox-visible");$(".shopbox-main").addClass("shopbox-visible");$(".shopbox .shopbox-content").html(b);return $(".shopbox").addClass("shopbox-loaded")};
a.setTypeStyle=function(a){return $(".shopbox").removeClass("shopbox-html shopbox-image shopbox-iframe shopbox-video").addClass(a)};a.loadFromContent=function(b,c,d){var f,g,e;b===void 0&&(b=d.attr("href"));d=c.type||this.typeFromContent(b);$(".shopbox-content").css({width:"",height:""});$(".shopbox-main").css({"margin-left":"","margin-top":""});a.show();if(d==="image"||d==="iframe")e=""+b+"?"+Math.random()*1E18;a.startSpinner();this.setTypeStyle("shopbox-"+d);switch(d){case "image":return d=$("<img />"),
d.load(function(b){a.setSize({height:c.height||this.height,width:c.width||this.width});return a.finishSpinner(b)}),d.attr("src",e),window.img=d;case "iframe":return g=$("<iframe></iframe>"),g.hide(),d={height:c.height||400,width:c.width||600},g.css(d),a.setSize(d),g.load(function(b){g.show();return a.finishSpinner(b)}),g.attr("src",e),$(".shopbox .shopbox-content").html(g);default:return f=$("<div />").css({display:"none"}),$(".shopbox .shopbox-content").html(f),f.ready(function(){return setTimeout(function(){a.setSize({height:c.height||
f.height(),width:c.width||f.width()});f.remove();return a.finishSpinner(b)},0)}),f.html(b)}};a.setSize=function(a){var c,d;d=document.width-50;c=document.height-50;if(d<a.width)a.width=d;if(c<a.height)a.height=c;$(".shopbox-content").css(a);return $(".shopbox-main").css({"margin-left":-a.width/2-10,"margin-top":-a.height/2-10})};e=["jpg","jpeg","png","bmp","gif"];a.typeFromContent=function(a){var c;if(a.nodeType!=null||a instanceof jQuery)return"object";c=a.split(".").pop().toLowerCase();return e.indexOf(c)>=
0?"image":a.match(/^https?\:\/\/\S+$/)?"iframe":"html"};return a}();window.ShopBox=h;jQuery.fn.shopbox=function(a,e){e==null&&(e={});h.init();return this.each(function(b,c){return $(c).click(function(b){b.preventDefault();return h.loadFromContent(a,e,$(c))})})};jQuery.fn.transitionEnd=function(a){return this.one("TransitionEnd webkitTransitionEnd transitionend oTransitionEnd",a)}}).call(this);
