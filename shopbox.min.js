(function(){var e;e=function(){function b(){}b.box=null;b.template='    <div class="shopbox-background shopbox-hidden">      <div class="shopbox-spinner"></div>      <div class="shopbox-main">        <div class="shopbox-inner">          <a class="shopbox-close" href="#">Close</a>          <div class="shopbox-content"></div>        </div>      </div>    </div>  ';b.init=function(){if($(".shopbox-background").length===0)return $("body").prepend(this.template),$(".shopbox-close").click(b.closeBox),$(window).bind("keydown",
function(a){if(a.which===27)return b.closeBox()}),$(".shopbox-background, .shopbox-spinner").bind("click",function(a){if(a.target===this)return b.closeBox()})};b.show=function(){$(".shopbox-background").removeClass("shopbox-hidden");return setTimeout(function(){return $(".shopbox-background").addClass("shopbox-visible")},0)};b.closeBox=function(a){a&&a.preventDefault();return b.hide()};b.hide=function(){if($(".shopbox-background").hasClass("shopbox-visible"))return $(".shopbox-background").removeClass("shopbox-visible"),
$(".shopbox-background").transitionEnd(function(){$(".shopbox-background").addClass("shopbox-hidden");$(".shopbox-main").removeClass("shopbox-visible");return $(".shopbox-background").removeClass("shopbox-loaded")})};b.startSpinner=function(){$(".shopbox-spinner").addClass("shopbox-visible");return $(".shopbox-main").removeClass("shopbox-visible")};b.finishSpinner=function(a){var b,a=a.target||a;b=$(".shopbox-spinner");b.hasClass("shopbox-visible")&&b.removeClass("shopbox-visible");$(".shopbox-main").addClass("shopbox-visible");
$(".shopbox-background .shopbox-content").html(a);return $(".shopbox-background").addClass("shopbox-loaded")};b.setTypeStyle=function(a){return $(".shopbox-background").removeClass("shopbox-html shopbox-image shopbox-iframe shopbox-video").addClass(a)};b.loadFromUrl=function(a,g,c){var d,f,e;a===void 0&&(a=c.attr("href"));c=g.type||this.typeFromUrl(a);$(".shopbox-content").css({width:"",height:""});$(".shopbox-main").css({"margin-left":"","margin-top":""});b.show();c!=="content"&&(e=""+a+"?"+Math.random()*
1E18,b.startSpinner());this.setTypeStyle("shopbox-"+c);switch(c){case "image":return c=$("<img />"),c.load(function(a){b.setSize({height:g.height||this.height,width:g.width||this.width});return b.finishSpinner(a)}),c.attr("src",e),window.img=c;case "iframe":return f=$("<iframe></iframe>"),f.hide(),c={height:g.height||400,width:g.width||600},f.css(c),b.setSize(c),f.load(function(a){f.show();return b.finishSpinner(a)}),f.attr("src",e),$(".shopbox-background .shopbox-content").html(f);default:return d=
$("<div />").css({display:"none"}),$(".shopbox-background .shopbox-content").html(d),d.ready(function(){return setTimeout(function(){$(".shopbox-main").css({"margin-left":-d.width()/2-10,"margin-top":-d.height()/2-10});d.remove();return b.finishSpinner(a)},0)}),d.html(a)}};b.setSize=function(a){var b,c;c=document.width-50;b=document.height-50;if(c<a.width)a.width=c;if(b<a.height)a.height=b;$(".shopbox-content").css(a);return $(".shopbox-main").css({"margin-left":-a.width/2-10,"margin-top":-a.height/
2-10})};b.typeFromUrl=function(a){return["jpg","jpeg","png","bmp","gif"].indexOf(a.split(".").pop().toLowerCase())>=0?"image":a.match(/^https?\:\/\/\S+$/)?"iframe":"html"};return b}();window.ShopBox=e;jQuery.fn.shopbox=function(b,a){a==null&&(a={});e.init();return this.each(function(g,c){return $(c).click(function(d){d.preventDefault();return e.loadFromUrl(b,a,$(c))})})};jQuery.fn.transitionEnd=function(b){return this.one("TransitionEnd webkitTransitionEnd transitionend oTransitionEnd",b)}}).call(this);
