(function(){var h;h=function(){function a(){}var d;a.box=null;a.template='    <div class="shopbox-background shopbox-hidden">      <div class="shopbox-spinner"></div>      <div class="shopbox-main">        <div class="shopbox-inner">          <a class="shopbox-close" href="#">Close</a>          <div class="shopbox-content"></div>        </div>      </div>    </div>  ';a.init=function(){if($(".shopbox-background").length===0)return $("body").prepend(this.template),$(".shopbox-close").click(a.closeBox),
$(window).bind("keydown",function(b){if(b.which===27)return a.closeBox()}),$(".shopbox-background, .shopbox-spinner").bind("click",function(b){if(b.target===this)return a.closeBox()})};a.show=function(){$(".shopbox-background").removeClass("shopbox-hidden");return setTimeout(function(){return $(".shopbox-background").addClass("shopbox-visible")},0)};a.closeBox=function(b){b&&b.preventDefault();return a.hide()};a.hide=function(){if($(".shopbox-background").hasClass("shopbox-visible"))return $(".shopbox-background").removeClass("shopbox-visible"),
$(".shopbox-background").transitionEnd(function(){$(".shopbox-background").addClass("shopbox-hidden");$(".shopbox-main").removeClass("shopbox-visible");return $(".shopbox-background").removeClass("shopbox-loaded")})};a.startSpinner=function(){$(".shopbox-spinner").addClass("shopbox-visible");return $(".shopbox-main").removeClass("shopbox-visible")};a.finishSpinner=function(b){var a,b=b.target||b;a=$(".shopbox-spinner");a.hasClass("shopbox-visible")&&a.removeClass("shopbox-visible");$(".shopbox-main").addClass("shopbox-visible");
$(".shopbox-background .shopbox-content").html(b);return $(".shopbox-background").addClass("shopbox-loaded")};a.setTypeStyle=function(b){return $(".shopbox-background").removeClass("shopbox-html shopbox-image shopbox-iframe shopbox-video").addClass(b)};a.loadFromContent=function(b,e,c){var f,g,d;b===void 0&&(b=c.attr("href"));c=e.type||this.typeFromContent(b);$(".shopbox-content").css({width:"",height:""});$(".shopbox-main").css({"margin-left":"","margin-top":""});a.show();if(c==="image"||c==="iframe")d=
""+b+"?"+Math.random()*1E18;a.startSpinner();this.setTypeStyle("shopbox-"+c);switch(c){case "image":return c=$("<img />"),c.load(function(b){a.setSize({height:e.height||this.height,width:e.width||this.width});return a.finishSpinner(b)}),c.attr("src",d),window.img=c;case "iframe":return g=$("<iframe></iframe>"),g.hide(),c={height:e.height||400,width:e.width||600},g.css(c),a.setSize(c),g.load(function(b){g.show();return a.finishSpinner(b)}),g.attr("src",d),$(".shopbox-background .shopbox-content").html(g);
default:return f=$("<div />").css({display:"none"}),$(".shopbox-background .shopbox-content").html(f),f.ready(function(){return setTimeout(function(){a.setSize({height:e.height||f.height(),width:e.width||f.width()});f.remove();return a.finishSpinner(b)},0)}),f.html(b)}};a.setSize=function(b){var a,c;c=document.width-50;a=document.height-50;if(c<b.width)b.width=c;if(a<b.height)b.height=a;$(".shopbox-content").css(b);return $(".shopbox-main").css({"margin-left":-b.width/2-10,"margin-top":-b.height/
2-10})};d=["jpg","jpeg","png","bmp","gif"];a.typeFromContent=function(b){var a;if(b.nodeType!=null||b instanceof jQuery)return"object";a=b.split(".").pop().toLowerCase();return d.indexOf(a)>=0?"image":b.match(/^https?\:\/\/\S+$/)?"iframe":"html"};return a}();window.ShopBox=h;jQuery.fn.shopbox=function(a,d){d==null&&(d={});h.init();return this.each(function(b,e){return $(e).click(function(b){b.preventDefault();return h.loadFromContent(a,d,$(e))})})};jQuery.fn.transitionEnd=function(a){return this.one("TransitionEnd webkitTransitionEnd transitionend oTransitionEnd",
a)}}).call(this);
